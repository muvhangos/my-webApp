<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>User Management System</title>
<style>
    * { box-sizing: border-box; font-family: Arial, sans-serif; }
    body { margin: 0; padding: 20px; background: #f4f4f9; }
    h1 { text-align: center; color: #333; }
    form, .controls, table { max-width: 900px; margin: 20px auto; background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);}
    form input, form select, .controls input, .controls button { width: 100%; padding: 8px; margin: 5px 0 15px 0; border-radius: 5px; border: 1px solid #ccc; }
    form button, .controls button { background: #5c6bc0; color: #fff; border: none; cursor: pointer; }
    form button:hover, .controls button:hover { background: #3949ab; }
    .controls { display: flex; gap: 10px; flex-wrap: wrap; }
    .controls input { flex: 1; }
    .controls button { flex: 0 0 auto; }
    table { width: 100%; border-collapse: collapse; }
    th, td { padding: 10px; text-align: left; border-bottom: 1px solid #ccc; }
    th { background: #5c6bc0; color: #fff; cursor: pointer; }
    td button { margin-right: 5px; padding: 5px 10px; border: none; border-radius: 5px; cursor: pointer; }
    .edit { background: #ffa000; color: #fff; }
    .delete { background: #e53935; color: #fff; }
</style>
</head>
<body>
<h1>User Management System</h1>

<form id="userForm">
    <input type="hidden" id="userId">
    <input type="text" id="name" placeholder="Full Name" required>
    <input type="email" id="email" placeholder="Email" required>
    <input type="text" id="phone" placeholder="Telephone Number" required>
    <input type="text" id="address" placeholder="Address" required>
    <input type="text" id="state" placeholder="State" required>
    <input type="text" id="zipcode" placeholder="Zip Code" required>
    <button type="submit">Add User</button>
</form>

<div class="controls">
    <input type="text" id="search" placeholder="Search users...">
    <button onclick="exportCSV()">Export CSV</button>
</div>

<table>
    <thead>
        <tr>
            <th onclick="sortTable('name')">Name ⬍</th>
            <th onclick="sortTable('email')">Email ⬍</th>
            <th onclick="sortTable('phone')">Phone ⬍</th>
            <th onclick="sortTable('address')">Address ⬍</th>
            <th onclick="sortTable('state')">State ⬍</th>
            <th onclick="sortTable('zipcode')">Zipcode ⬍</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody id="userTable"></tbody>
</table>

<script>
const form = document.getElementById('userForm');
const table = document.getElementById('userTable');
const searchInput = document.getElementById('search');
let users = JSON.parse(localStorage.getItem('users')) || [];
let sortDir = {};

function render(filtered = users) {
    table.innerHTML = '';
    filtered.forEach((user, i) => {
        table.innerHTML += `
        <tr>
            <td>${user.name}</td>
            <td>${user.email}</td>
            <td>${user.phone}</td>
            <td>${user.address}</td>
            <td>${user.state}</td>
            <td>${user.zipcode}</td>
            <td>
                <button class="edit" onclick="editUser(${i})">Edit</button>
                <button class="delete" onclick="deleteUser(${i})">Delete</button>
            </td>
        </tr>`;
    });
}

function resetForm() {
    form.reset();
    document.getElementById('userId').value = '';
    form.querySelector('button').textContent = 'Add User';
}

form.addEventListener('submit', e => {
    e.preventDefault();
    const id = document.getElementById('userId').value;
    const user = {
        name: document.getElementById('name').value,
        email: document.getElementById('email').value,
        phone: document.getElementById('phone').value,
        address: document.getElementById('address').value,
        state: document.getElementById('state').value,
        zipcode: document.getElementById('zipcode').value
    };
    if(id === '') users.push(user);
    else users[id] = user;
    localStorage.setItem('users', JSON.stringify(users));
    render();
    resetForm();
});

function editUser(i) {
    const user = users[i];
    document.getElementById('userId').value = i;
    document.getElementById('name').value = user.name;
    document.getElementById('email').value = user.email;
    document.getElementById('phone').value = user.phone;
    document.getElementById('address').value = user.address;
    document.getElementById('state').value = user.state;
    document.getElementById('zipcode').value = user.zipcode;
    form.querySelector('button').textContent = 'Update User';
}

function deleteUser(i) {
    if(confirm('Are you sure you want to delete this user?')) {
        users.splice(i, 1);
        localStorage.setItem('users', JSON.stringify(users));
        render();
    }
}

searchInput.addEventListener('input', () => {
    const term = searchInput.value.toLowerCase();
    const filtered = users.filter(u =>
        Object.values(u).some(v => v.toLowerCase().includes(term))
    );
    render(filtered);
});

function sortTable(key) {
    sortDir[key] = !sortDir[key];
    users.sort((a,b) => {
        let x = a[key].toLowerCase(), y = b[key].toLowerCase();
        return sortDir[key] ? x > y ? 1 : -1 : x < y ? 1 : -1;
    });
    render();
}

function exportCSV() {
    const headers = ["Name","Email","Phone","Address","State","Zipcode"];
    const rows = users.map(u => [u.name,u.email,u.phone,u.address,u.state,u.zipcode].join(','));
    const csv = [headers.join(','), ...rows].join('\n');
    const blob = new Blob([csv], {type: 'text/csv'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url; a.download = 'users.csv'; a.click();
    URL.revokeObjectURL(url);
}

// Initial render
render();
</script>
</body>
</html>
